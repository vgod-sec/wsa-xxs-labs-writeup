
## Extended Description (One Line)
Stored XSS vulnerability in blog comments where unencoded user input is directly inserted into the HTML context, allowing script execution.

## Complete Write-up

This lab demonstrates a **stored cross-site scripting (XSS)** vulnerability in the comment section of a blog where user-supplied input is embedded into the HTML page without encoding or sanitization. As a result, an attacker can inject malicious JavaScript which will be executed in the browser of anyone who views the blog post. To exploit this, open any blog post in the application and scroll to the "Leave a comment" section. In the comment field, input the payload `<script>alert(1)</script>`. Then fill out the remaining fields: Name as `attacker`, Email as `attacker@example.com`, and Website as `http://example.com`. Click the "Post comment" button. Once submitted, go back to the blog post. You will see a JavaScript alert box appear showing the number `1`, confirming successful execution of the script. This works because the server stores the comment content and later reflects it on the blog post page without performing any kind of output encoding. The browser interprets the `<script>` tag as actual code and runs it. Since this is a stored XSS vulnerability, it will be executed not only for the attacker but for any visitor to the blog post. The impact of this vulnerability is severe. Attackers can steal session cookies, hijack accounts, perform unauthorized actions on behalf of users, or serve malicious content. To mitigate this vulnerability, the application should properly **encode output** before inserting user content into HTML. Special characters like `<`, `>`, `"`, `'`, and `&` should be safely encoded depending on the context (HTML body, attribute, JavaScript, etc.). If HTML input must be allowed, use a sanitization library like **DOMPurify** to remove dangerous elements and attributes. Additionally, implement a strong **Content Security Policy (CSP)** to restrict the execution of inline scripts and third-party resources. Using modern frontend frameworks such as React, Angular, or Vue can also help prevent XSS by escaping data by default. Security headers like `Content-Security-Policy`, `X-Content-Type-Options`, and `X-Frame-Options` should be configured. In summary, stored XSS is highly dangerous because it persists across sessions and affects all users who load the compromised page. Proper output encoding, input sanitization, use of secure development practices, and security headers are essential to prevent such attacks.
