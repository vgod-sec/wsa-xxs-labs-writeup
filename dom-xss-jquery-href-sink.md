This lab demonstrates a DOM-based Cross-Site Scripting (XSS) vulnerability caused by unsafe handling of URL parameters using jQuery. The application uses the jQuery `$` selector to find an anchor (`<a>`) element and sets its `href` attribute using untrusted data from `location.search`, specifically the `returnPath` parameter. This allows an attacker to inject a malicious JavaScript URI, resulting in code execution. To exploit this, navigate to the Submit feedback page and modify the `returnPath` parameter in the URL to: `javascript:alert(document.cookie)`. When the page loads, jQuery assigns this value directly to the `href` attribute of the back link without validation. Clicking the back link then executes the payload, displaying the user’s cookies via an alert box. This vulnerability arises because jQuery manipulates the DOM using unsanitized user input, allowing for the injection of dangerous schemes like `javascript:` into HTML attributes. The impact of this XSS can be severe, including cookie theft, session hijacking, phishing, and execution of arbitrary JavaScript in the context of the victim’s browser session. To mitigate such risks, developers should avoid setting `href` or `src` attributes using untrusted input. Instead, validate and sanitize URLs to ensure they use safe schemes (e.g., http/https only). Enforcing a strong Content Security Policy (CSP) and avoiding dynamic insertion of URLs using client-side scripts also helps in preventing these issues. This lab highlights how powerful and dangerous DOM-based XSS can be when JavaScript libraries like jQuery are used without secure input handling.
