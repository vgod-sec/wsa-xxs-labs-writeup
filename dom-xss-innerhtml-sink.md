This lab demonstrates a DOM-based Cross-Site Scripting (XSS) vulnerability in the search functionality of a blog website. The application reads user input from the URL query string (location.search) and inserts it directly into the HTML of the page using innerHTML without any form of sanitization or validation. This allows an attacker to inject arbitrary HTML and JavaScript into the page. To exploit this, enter the following payload into the search box: `<img src=x onerror=alert(1)>` and click "Search". The application reflects the input directly into the DOM using innerHTML. Because the src attribute is invalid, the browser triggers the onerror event, which executes alert(1), confirming successful XSS. This vulnerability poses a significant security risk, allowing an attacker to execute scripts in the victim's browser, which can lead to session hijacking, credential theft, DOM manipulation, phishing, or unauthorized actions. To prevent this, developers must avoid using innerHTML with untrusted data and instead use safer methods like textContent or createElement. If inserting HTML is required, use a library like DOMPurify to sanitize the input. A strict Content Security Policy (CSP) should also be implemented to restrict inline script execution. This lab highlights how unsafe DOM manipulation using innerHTML can result in client-side XSS and emphasizes the importance of secure coding practices and proper input handling in modern web applications.
